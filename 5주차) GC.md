2021/04/10

- 장태진

- NodeJS 를 사용해서 서버를 쉽게 구성할 수 있게 한 것이 Express 다.
- 라우팅은 클라이언트에서 보내는 주소에 따라 다른 처리를 하는 것을 의미한다.
- REST 메소드 use,get, post, put, delete 메소드를 사용할 수 있다.
- 메소드 선언 순서가 중요하다
- 주소 부분은 정규표현식도 가능하고 : 을 이용한 와일드카드도 가능하다
- request 의 주된 파라미터
	- params : 라우터 파라미터를 지녔다
	- query : GET 방식으로 넘어오는 쿼리 스트링 파라미터를 가짐
	- body : POST 방식으로 넘어오는 파라미터를 지니머 파싱을 위해 body-parser 와 같은 미들웨어를 쓸수있다
- bodyparser 를 사용하게 되면 요청의 본문을 해석할 수 있다.
- response
	- send, sendFile, json, redirect 메소드가 있음
	- redirect 메서드로 응답을 다른 라우터로 전달하는 등 작업가능
- next : 현재 라우터에서 판단하지 않고 다음 라우터로 넘기는 행위, 넘겨진 라우터의 메소드를 모두 실행 후 다음행을 실행한다.
- next('route') : 라우터에 연결된 나머지 미들웨어들을 건너뛰고 다음 라우터의 메소드를 실행하고 다음 행을 실행한다.
- 미들웨어 : 요청과 응답의 중간에 위치한 미들웨어는 주로 app.use 와 함께 사용된다.
	- 어플리케이션 레벨 미들웨어는 app 메소드를 통해 등록한 미들웨어다.
	- 라우터 레벨 미들웨어는 router 에서 작동하는 미들웨어다
	- 오류 처리 미들웨어는 에러 처리를 위해 사용하는 미들웨어이다.
	- 써드파티 미들웨어는 body-parser 와 같은 미들웨어를 말한다.
- express-session
- 세션 관리용 미들웨어로 클리이언트에 쿠키를 보낸다.
- resasve : 요청을 왔을때 세션 수정이 생기지 않아도 세션을 다시 저장할지 설정
- saveUninitialized : 세션에 저장할 내역이 없어도 방문자 추적용으로 세션을 저장할지 등
- secret : 쿠키를 임의로 변조하는 것을 방지하기 위한 값으로 세션 암호화하여 저장

- 김성태

- GC : 가비지 컬렉션 
- 자바의 경우 동적으로 메모리를 할당하는데 GC 를 활용해 메모리를 관리한다.
- GC 의 경우, GC 쓰레드 실행 과정에서 자원이 들고 Stop-the-world 현상으로 서비스 순단이 발생할 수 있다.
- 힙 메모리 영역에 NEW/OLD 영역 EDEN 영역 등이 있다.
- 객체를 만들면 NEW 영역 - EDEN 영역에 생기고 POOL 이 차면 EDEN 에서 사용하는 객체들은 FROM 으로 이후 SUVIVOR 영역으로 보낸다.
- SUVIVOR 영역도 다 차면 OLD 영역으로 간다.
- EDEN, SUVIVOR 영역에서 일어나는 GC 를 Minor GC 라고 한다.
- OLD 영역에서 발생하는 GC 를 FULL GC 라고 한다.
- Stop-the-world 로 인해 Queue 가 쌓이면 서비스 부하가 생긴다.
- OLD 영역이 작게 할당되면 NEW 에서 OLD 로 넘어갈때 OOM 가 날 수 있다.
- 관리 옵션
	- Xms, Xmx : Heap 메모리 초기 할당량
	- XX NewSize : New 영역 초기 할당값
	- etc
- GC 모니터링 옵션을 줘서 상세정보를 출력할 수 있다.
- OOM 발생 시, Heap 덤프를 생성하는 옵션을 줄 수 있다.
- 힙덤프에는 Full GC 의 횟수, PSYoungGen(Young 영역) 등의 정보가 남는다.
- before, after 내용 덤프를 통해 어느 과정에서 발생하는지 파악할 수 있다. (맨아래에는 요약남음)
- Full GC : Young 에서 사용하는 것만 EDEN 으로 옮기고 이후 OLD 로 옮기는 과정에서 어떤 부분이 문제였는지 알 수 있다.
- GUI 를 통한 GC 추이 분석
	- GCeasy : 파일을 옮기거나 로우를 치면 분석해줌
	- IBM JAVA Garbage Collector ... : GUI 그래프 등으로 GC 의 횟수 시간을 볼 수 있다.
	- etc
- GC 튜닝 : 튜닝이 필요한 CASE 는 Minor GC 의 처리시간이 빠르거나 주기가 빈번하지 않고, Full GC 처리시간이 빠르거나 주기가 빈번하지 않으면 고려해본다.
- OLD 영역을 줄이면 Full GC 시간은 줄어드나 횟수가 증가하고, NEW 영역에서 넘어올때 OOM 이 발생할 수 있다.
- OLD 영역을 늘리면 Full GC 횟수는 줄어드나 시간이 증가한다.
- Stop-the-world 가 생겼을때 Full GC 가 1초 초과할 경우 DB timeout 설정에 따라 DB가 안붙을 수 있어 튜닝이 필요할 수 있다.